(function(A){var B={set:{colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,focus:1},get:{selectedRegions:1,selectedMarkers:1,mapObject:1,regionName:1}};A.fn.vectorMap=function(D){var E,C,F,E=this.children(".jvectormap-container").data("mapObject");if(D==="addMap"){jvm.WorldMap.maps[arguments[1]]=arguments[2]}else{if(!(D!=="set"&&D!=="get"||!B[D][arguments[1]])){return C=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1),E[D+C].apply(E,Array.prototype.slice.call(arguments,2))}D=D||{},D.container=this,E=new jvm.WorldMap(D)}return this}})(jQuery),function(B){function A(J){var F=J||window.event,E=[].slice.call(arguments,1),G=0,H=!0,I=0,K=0;return J=B.event.fix(F),J.type="mousewheel",F.wheelDelta&&(G=F.wheelDelta/120),F.detail&&(G=-F.detail/3),K=G,F.axis!==undefined&&F.axis===F.HORIZONTAL_AXIS&&(K=0,I=-1*G),F.wheelDeltaY!==undefined&&(K=F.wheelDeltaY/120),F.wheelDeltaX!==undefined&&(I=-1*F.wheelDeltaX/120),E.unshift(J,G,I,K),(B.event.dispatch||B.event.handle).apply(this,E)}var D=["DOMMouseScroll","mousewheel"];if(B.event.fixHooks){for(var C=D.length;C;){B.event.fixHooks[D[--C]]=B.event.mouseHooks}}B.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var E=D.length;E;){this.addEventListener(D[--E],A,!1)}}else{this.onmousewheel=A}},teardown:function(){if(this.removeEventListener){for(var E=D.length;E;){this.removeEventListener(D[--E],A,!1)}}else{this.onmousewheel=null}}},B.fn.extend({mousewheel:function(E){return E?this.bind("mousewheel",E):this.trigger("mousewheel")},unmousewheel:function(E){return this.unbind("mousewheel",E)}})}(jQuery);var jvm={inherits:function(A,C){function B(){}B.prototype=C.prototype,A.prototype=new B,A.prototype.constructor=A,A.parentClass=C},mixin:function(A,C){var B;for(B in C.prototype){C.prototype.hasOwnProperty(B)&&(A.prototype[B]=C.prototype[B])}},min:function(A){var C=Number.MAX_VALUE,B;if(A instanceof Array){for(B=0;B<A.length;B++){A[B]<C&&(C=A[B])}}else{for(B in A){A[B]<C&&(C=A[B])}}return C},max:function(A){var C=Number.MIN_VALUE,B;if(A instanceof Array){for(B=0;B<A.length;B++){A[B]>C&&(C=A[B])}}else{for(B in A){A[B]>C&&(C=A[B])}}return C},keys:function(A){var C=[],B;for(B in A){C.push(B)}return C},values:function(B){var D=[],C,A;for(A=0;A<arguments.length;A++){B=arguments[A];for(C in B){D.push(B[C])}}return D}};jvm.$=jQuery,jvm.AbstractElement=function(A,B){this.node=this.createElement(A),this.name=A,this.properties={},B&&this.set(B)},jvm.AbstractElement.prototype.set=function(A,C){var B;if(typeof A=="object"){for(B in A){this.properties[B]=A[B],this.applyAttr(B,A[B])}}else{this.properties[A]=C,this.applyAttr(A,C)}},jvm.AbstractElement.prototype.get=function(A){return this.properties[A]},jvm.AbstractElement.prototype.applyAttr=function(A,B){this.node.setAttribute(A,B)},jvm.AbstractElement.prototype.remove=function(){jvm.$(this.node).remove()},jvm.AbstractCanvasElement=function(A,C,B){this.container=A,this.setSize(C,B),this.rootElement=new jvm[this.classPrefix+"GroupElement"],this.node.appendChild(this.rootElement.node),this.container.appendChild(this.node)},jvm.AbstractCanvasElement.prototype.add=function(A,B){B=B||this.rootElement,B.add(A),A.canvas=this},jvm.AbstractCanvasElement.prototype.addPath=function(B,D,C){var A=new jvm[this.classPrefix+"PathElement"](B,D);return this.add(A,C),A},jvm.AbstractCanvasElement.prototype.addCircle=function(B,D,C){var A=new jvm[this.classPrefix+"CircleElement"](B,D);return this.add(A,C),A},jvm.AbstractCanvasElement.prototype.addGroup=function(A){var B=new jvm[this.classPrefix+"GroupElement"];return A?A.node.appendChild(B.node):this.node.appendChild(B.node),B.canvas=this,B},jvm.AbstractShapeElement=function(A,C,B){this.style=B||{},this.style.current={},this.isHovered=!1,this.isSelected=!1,this.updateStyle()},jvm.AbstractShapeElement.prototype.setHovered=function(A){this.isHovered!==A&&(this.isHovered=A,this.updateStyle())},jvm.AbstractShapeElement.prototype.setSelected=function(A){this.isSelected!==A&&(this.isSelected=A,this.updateStyle(),jvm.$(this.node).trigger("selected",[A]))},jvm.AbstractShapeElement.prototype.setStyle=function(A,C){var B={};typeof A=="object"?B=A:B[A]=C,jvm.$.extend(this.style.current,B),this.updateStyle()},jvm.AbstractShapeElement.prototype.updateStyle=function(){var A={};jvm.AbstractShapeElement.mergeStyles(A,this.style.initial),jvm.AbstractShapeElement.mergeStyles(A,this.style.current),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(A,this.style.hover),this.isSelected&&(jvm.AbstractShapeElement.mergeStyles(A,this.style.selected),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(A,this.style.selectedHover)),this.set(A)},jvm.AbstractShapeElement.mergeStyles=function(A,C){var B;C=C||{};for(B in C){C[B]===null?delete A[B]:A[B]=C[B]}},jvm.SVGElement=function(A,B){jvm.SVGElement.parentClass.apply(this,arguments)},jvm.inherits(jvm.SVGElement,jvm.AbstractElement),jvm.SVGElement.svgns="http://www.w3.org/2000/svg",jvm.SVGElement.prototype.createElement=function(A){return document.createElementNS(jvm.SVGElement.svgns,A)},jvm.SVGElement.prototype.addClass=function(A){this.node.setAttribute("class",A)},jvm.SVGElement.prototype.getElementCtr=function(A){return jvm["SVG"+A]},jvm.SVGElement.prototype.getBBox=function(){return this.node.getBBox()},jvm.SVGGroupElement=function(){jvm.SVGGroupElement.parentClass.call(this,"g")},jvm.inherits(jvm.SVGGroupElement,jvm.SVGElement),jvm.SVGGroupElement.prototype.add=function(A){this.node.appendChild(A.node)},jvm.SVGCanvasElement=function(A,C,B){this.classPrefix="SVG",jvm.SVGCanvasElement.parentClass.call(this,"svg"),jvm.AbstractCanvasElement.apply(this,arguments)},jvm.inherits(jvm.SVGCanvasElement,jvm.SVGElement),jvm.mixin(jvm.SVGCanvasElement,jvm.AbstractCanvasElement),jvm.SVGCanvasElement.prototype.setSize=function(A,B){this.width=A,this.height=B,this.node.setAttribute("width",A),this.node.setAttribute("height",B)},jvm.SVGCanvasElement.prototype.applyTransformParams=function(A,C,B){this.scale=A,this.transX=C,this.transY=B,this.rootElement.node.setAttribute("transform","scale("+A+") translate("+C+", "+B+")")},jvm.SVGShapeElement=function(A,C,B){jvm.SVGShapeElement.parentClass.call(this,A,C),jvm.AbstractShapeElement.apply(this,arguments)},jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement),jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement),jvm.SVGPathElement=function(A,B){jvm.SVGPathElement.parentClass.call(this,"path",A,B),this.node.setAttribute("fill-rule","evenodd")},jvm.inherits(jvm.SVGPathElement,jvm.SVGShapeElement),jvm.SVGCircleElement=function(A,B){jvm.SVGCircleElement.parentClass.call(this,"circle",A,B)},jvm.inherits(jvm.SVGCircleElement,jvm.SVGShapeElement),jvm.VMLElement=function(A,B){jvm.VMLElement.VMLInitialized||jvm.VMLElement.initializeVML(),jvm.VMLElement.parentClass.apply(this,arguments)},jvm.inherits(jvm.VMLElement,jvm.AbstractElement),jvm.VMLElement.VMLInitialized=!1,jvm.VMLElement.initializeVML=function(){try{document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),jvm.VMLElement.prototype.createElement=function(B){return document.createElement("<rvml:"+B+' class="rvml">')}}catch(A){jvm.VMLElement.prototype.createElement=function(B){return document.createElement("<"+B+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"),jvm.VMLElement.VMLInitialized=!0},jvm.VMLElement.prototype.getElementCtr=function(A){return jvm["VML"+A]},jvm.VMLElement.prototype.addClass=function(A){jvm.$(this.node).addClass(A)},jvm.VMLElement.prototype.applyAttr=function(A,B){this.node[A]=B},jvm.VMLElement.prototype.getBBox=function(){var A=jvm.$(this.node);return{x:A.position().left/this.canvas.scale,y:A.position().top/this.canvas.scale,width:A.width()/this.canvas.scale,height:A.height()/this.canvas.scale}},jvm.VMLGroupElement=function(){jvm.VMLGroupElement.parentClass.call(this,"group"),this.node.style.left="0px",this.node.style.top="0px",this.node.coordorigin="0 0"},jvm.inherits(jvm.VMLGroupElement,jvm.VMLElement),jvm.VMLGroupElement.prototype.add=function(A){this.node.appendChild(A.node)},jvm.VMLCanvasElement=function(A,C,B){this.classPrefix="VML",jvm.VMLCanvasElement.parentClass.call(this,"group"),jvm.AbstractCanvasElement.apply(this,arguments),this.node.style.position="absolute"},jvm.inherits(jvm.VMLCanvasElement,jvm.VMLElement),jvm.mixin(jvm.VMLCanvasElement,jvm.AbstractCanvasElement),jvm.VMLCanvasElement.prototype.setSize=function(B,F){var C,A,D,E;this.width=B,this.height=F,this.node.style.width=B+"px",this.node.style.height=F+"px",this.node.coordsize=B+" "+F,this.node.coordorigin="0 0";if(this.rootElement){C=this.rootElement.node.getElementsByTagName("shape");for(D=0,E=C.length;D<E;D++){C[D].coordsize=B+" "+F,C[D].style.width=B+"px",C[D].style.height=F+"px"}A=this.node.getElementsByTagName("group");for(D=0,E=A.length;D<E;D++){A[D].coordsize=B+" "+F,A[D].style.width=B+"px",A[D].style.height=F+"px"}}},jvm.VMLCanvasElement.prototype.applyTransformParams=function(A,C,B){this.scale=A,this.transX=C,this.transY=B,this.rootElement.node.coordorigin=this.width-C-this.width/100+","+(this.height-B-this.height/100),this.rootElement.node.coordsize=this.width/A+","+this.height/A},jvm.VMLShapeElement=function(A,B){jvm.VMLShapeElement.parentClass.call(this,A,B),this.fillElement=new jvm.VMLElement("fill"),this.strokeElement=new jvm.VMLElement("stroke"),this.node.appendChild(this.fillElement.node),this.node.appendChild(this.strokeElement.node),this.node.stroked=!1,jvm.AbstractShapeElement.apply(this,arguments)},jvm.inherits(jvm.VMLShapeElement,jvm.VMLElement),jvm.mixin(jvm.VMLShapeElement,jvm.AbstractShapeElement),jvm.VMLShapeElement.prototype.applyAttr=function(A,B){switch(A){case"fill":this.node.fillcolor=B;break;case"fill-opacity":this.fillElement.node.opacity=Math.round(B*100)+"%";break;case"stroke":B==="none"?this.node.stroked=!1:this.node.stroked=!0,this.node.strokecolor=B;break;case"stroke-opacity":this.strokeElement.node.opacity=Math.round(B*100)+"%";break;case"stroke-width":parseInt(B,10)===0?this.node.stroked=!1:this.node.stroked=!0,this.node.strokeweight=B;break;case"d":this.node.path=jvm.VMLPathElement.pathSvgToVml(B);break;default:jvm.VMLShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}},jvm.VMLPathElement=function(A,C){var B=new jvm.VMLElement("skew");jvm.VMLPathElement.parentClass.call(this,"shape",A,C),this.node.coordorigin="0 0",B.node.on=!0,B.node.matrix="0.01,0,0,0.01,0,0",B.node.offset="0,0",this.node.appendChild(B.node)},jvm.inherits(jvm.VMLPathElement,jvm.VMLShapeElement),jvm.VMLPathElement.prototype.applyAttr=function(A,B){A==="d"?this.node.path=jvm.VMLPathElement.pathSvgToVml(B):jvm.VMLShapeElement.prototype.applyAttr.call(this,A,B)},jvm.VMLPathElement.pathSvgToVml=function(B){var F="",C=0,A=0,D,E;return B=B.replace(/(-?\d+)e(-?\d+)/g,"0"),B.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(G,I,H,J){H=H.replace(/(\d)-/g,"$1,-").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g,",").split(","),H[0]||H.shift();for(var K=0,L=H.length;K<L;K++){H[K]=Math.round(100*H[K])}switch(I){case"m":return C+=H[0],A+=H[1],"t"+H.join(",");case"M":return C=H[0],A=H[1],"m"+H.join(",");case"l":return C+=H[0],A+=H[1],"r"+H.join(",");case"L":return C=H[0],A=H[1],"l"+H.join(",");case"h":return C+=H[0],"r"+H[0]+",0";case"H":return C=H[0],"l"+C+","+A;case"v":return A+=H[0],"r0,"+H[0];case"V":return A=H[0],"l"+C+","+A;case"c":return D=C+H[H.length-4],E=A+H[H.length-3],C+=H[H.length-2],A+=H[H.length-1],"v"+H.join(",");case"C":return D=H[H.length-4],E=H[H.length-3],C=H[H.length-2],A=H[H.length-1],"c"+H.join(",");case"s":return H.unshift(A-E),H.unshift(C-D),D=C+H[H.length-4],E=A+H[H.length-3],C+=H[H.length-2],A+=H[H.length-1],"v"+H.join(",");case"S":return H.unshift(A+A-E),H.unshift(C+C-D),D=H[H.length-4],E=H[H.length-3],C=H[H.length-2],A=H[H.length-1],"c"+H.join(",")}return""}).replace(/z/g,"e")},jvm.VMLCircleElement=function(A,B){jvm.VMLCircleElement.parentClass.call(this,"oval",A,B)},jvm.inherits(jvm.VMLCircleElement,jvm.VMLShapeElement),jvm.VMLCircleElement.prototype.applyAttr=function(A,B){switch(A){case"r":this.node.style.width=B*2+"px",this.node.style.height=B*2+"px",this.applyAttr("cx",this.get("cx")||0),this.applyAttr("cy",this.get("cy")||0);break;case"cx":if(!B){return}this.node.style.left=B-(this.get("r")||0)+"px";break;case"cy":if(!B){return}this.node.style.top=B-(this.get("r")||0)+"px";break;default:jvm.VMLCircleElement.parentClass.prototype.applyAttr.call(this,A,B)}},jvm.VectorCanvas=function(A,C,B){return this.mode=window.SVGAngle?"svg":"vml",this.mode=="svg"?this.impl=new jvm.SVGCanvasElement(A,C,B):this.impl=new jvm.VMLCanvasElement(A,C,B),this.impl},jvm.SimpleScale=function(A){this.scale=A},jvm.SimpleScale.prototype.getValue=function(A){return A},jvm.OrdinalScale=function(A){this.scale=A},jvm.OrdinalScale.prototype.getValue=function(A){return this.scale[A]},jvm.NumericScale=function(B,D,C,A){this.scale=[],D=D||"linear",B&&this.setScale(B),D&&this.setNormalizeFunction(D),C&&this.setMin(C),A&&this.setMax(A)},jvm.NumericScale.prototype={setMin:function(A){this.clearMinValue=A,typeof this.normalize=="function"?this.minValue=this.normalize(A):this.minValue=A},setMax:function(A){this.clearMaxValue=A,typeof this.normalize=="function"?this.maxValue=this.normalize(A):this.maxValue=A},setScale:function(A){var B;for(B=0;B<A.length;B++){this.scale[B]=[A[B]]}},setNormalizeFunction:function(A){A==="polynomial"?this.normalize=function(B){return Math.pow(B,0.2)}:A==="linear"?delete this.normalize:this.normalize=A,this.setMin(this.clearMinValue),this.setMax(this.clearMaxValue)},getValue:function(B){var F=[],C=0,A,D=0,E;typeof this.normalize=="function"&&(B=this.normalize(B));for(D=0;D<this.scale.length-1;D++){A=this.vectorLength(this.vectorSubtract(this.scale[D+1],this.scale[D])),F.push(A),C+=A}E=(this.maxValue-this.minValue)/C;for(D=0;D<F.length;D++){F[D]*=E}D=0,B-=this.minValue;while(B-F[D]>=0){B-=F[D],D++}return D==this.scale.length-1?B=this.vectorToNum(this.scale[D]):B=this.vectorToNum(this.vectorAdd(this.scale[D],this.vectorMult(this.vectorSubtract(this.scale[D+1],this.scale[D]),B/F[D]))),B},vectorToNum:function(A){var C=0,B;for(B=0;B<A.length;B++){C+=Math.round(A[B])*Math.pow(256,A.length-B-1)}return C},vectorSubtract:function(B,D){var C=[],A;for(A=0;A<B.length;A++){C[A]=B[A]-D[A]}return C},vectorAdd:function(B,D){var C=[],A;for(A=0;A<B.length;A++){C[A]=B[A]+D[A]}return C},vectorMult:function(B,D){var C=[],A;for(A=0;A<B.length;A++){C[A]=B[A]*D}return C},vectorLength:function(A){var C=0,B;for(B=0;B<A.length;B++){C+=A[B]*A[B]}return Math.sqrt(C)}},jvm.ColorScale=function(B,D,C,A){jvm.ColorScale.parentClass.apply(this,arguments)},jvm.inherits(jvm.ColorScale,jvm.NumericScale),jvm.ColorScale.prototype.setScale=function(A){var B;for(B=0;B<A.length;B++){this.scale[B]=jvm.ColorScale.rgbToArray(A[B])}},jvm.ColorScale.prototype.getValue=function(A){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,A))},jvm.ColorScale.arrayToRgb=function(B){var D="#",C,A;for(A=0;A<B.length;A++){C=B[A].toString(16),D+=C.length==1?"0"+C:C}return D},jvm.ColorScale.numToRgb=function(A){A=A.toString(16);while(A.length<6){A="0"+A}return"#"+A},jvm.ColorScale.rgbToArray=function(A){return A=A.substr(1),[parseInt(A.substr(0,2),16),parseInt(A.substr(2,2),16),parseInt(A.substr(4,2),16)]},jvm.DataSeries=function(A,C){var B;A=A||{},A.attribute=A.attribute||"fill",this.elements=C,this.params=A,A.attributes&&this.setAttributes(A.attributes),jvm.$.isArray(A.scale)?(B=A.attribute==="fill"||A.attribute==="stroke"?jvm.ColorScale:jvm.NumericScale,this.scale=new B(A.scale,A.normalizeFunction,A.min,A.max)):A.scale?this.scale=new jvm.OrdinalScale(A.scale):this.scale=new jvm.SimpleScale(A.scale),this.values=A.values||{},this.setValues(this.values)},jvm.DataSeries.prototype={setAttributes:function(B,D){var C=B,A;if(typeof B=="string"){this.elements[B]&&this.elements[B].setStyle(this.params.attribute,D)}else{for(A in C){this.elements[A]&&this.elements[A].element.setStyle(this.params.attribute,C[A])}}},setValues:function(B){var F=Number.MIN_VALUE,C=Number.MAX_VALUE,A,D,E={};if(this.scale instanceof jvm.OrdinalScale||this.scale instanceof jvm.SimpleScale){for(D in B){B[D]?E[D]=this.scale.getValue(B[D]):E[D]=this.elements[D].element.style.initial[this.params.attribute]}}else{if(!this.params.min||!this.params.max){for(D in B){A=parseFloat(B[D]),A>F&&(F=B[D]),A<C&&(C=A)}this.params.min||this.scale.setMin(C),this.params.max||this.scale.setMax(F),this.params.min=C,this.params.max=F}for(D in B){A=parseFloat(B[D]),isNaN(A)?E[D]=this.elements[D].element.style.initial[this.params.attribute]:E[D]=this.scale.getValue(A)}}this.setAttributes(E),jvm.$.extend(this.values,B)},clear:function(){var A,B={};for(A in this.values){this.elements[A]&&(B[A]=this.elements[A].element.style.initial[this.params.attribute])}this.setAttributes(B),this.values={}},setScale:function(A){this.scale.setScale(A),this.values&&this.setValues(this.values)},setNormalizeFunction:function(A){this.scale.setNormalizeFunction(A),this.values&&this.setValues(this.values)}},jvm.Proj={degRad:180/Math.PI,radDeg:Math.PI/180,radius:6381372,sgn:function(A){return A>0?1:A<0?-1:A},mill:function(A,C,B){return{x:this.radius*(C-B)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+0.4*A)*this.radDeg))/0.8}},mill_inv:function(A,C,B){return{lat:(2.5*Math.atan(Math.exp(0.8*C/this.radius))-5*Math.PI/8)*this.degRad,lng:(B*this.radDeg+A/this.radius)*this.degRad}},merc:function(A,C,B){return{x:this.radius*(C-B)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+A*Math.PI/360))}},merc_inv:function(A,C,B){return{lat:(2*Math.atan(Math.exp(C/this.radius))-Math.PI/2)*this.degRad,lng:(B*this.radDeg+A/this.radius)*this.degRad}},aea:function(A,E,I){var D=0,H=I*this.radDeg,B=29.5*this.radDeg,J=45.5*this.radDeg,F=A*this.radDeg,M=E*this.radDeg,N=(Math.sin(B)+Math.sin(J))/2,K=Math.cos(B)*Math.cos(B)+2*N*Math.sin(B),L=N*(M-H),G=Math.sqrt(K-2*N*Math.sin(F))/N,C=Math.sqrt(K-2*N*Math.sin(D))/N;return{x:G*Math.sin(L)*this.radius,y:-(C-G*Math.cos(L))*this.radius}},aea_inv:function(A,E,I){var D=A/this.radius,H=E/this.radius,B=0,J=I*this.radDeg,F=29.5*this.radDeg,M=45.5*this.radDeg,N=(Math.sin(F)+Math.sin(M))/2,K=Math.cos(F)*Math.cos(F)+2*N*Math.sin(F),L=Math.sqrt(K-2*N*Math.sin(B))/N,G=Math.sqrt(D*D+(L-H)*(L-H)),C=Math.atan(D/(L-H));return{lat:Math.asin((K-G*G*N*N)/(2*N))*this.degRad,lng:(J+C/N)*this.degRad}},lcc:function(A,D,H){var C=0,G=H*this.radDeg,B=D*this.radDeg,I=33*this.radDeg,E=45*this.radDeg,L=A*this.radDeg,M=Math.log(Math.cos(I)*(1/Math.cos(E)))/Math.log(Math.tan(Math.PI/4+E/2)*(1/Math.tan(Math.PI/4+I/2))),J=Math.cos(I)*Math.pow(Math.tan(Math.PI/4+I/2),M)/M,K=J*Math.pow(1/Math.tan(Math.PI/4+L/2),M),F=J*Math.pow(1/Math.tan(Math.PI/4+C/2),M);return{x:K*Math.sin(M*(B-G))*this.radius,y:-(F-K*Math.cos(M*(B-G)))*this.radius}},lcc_inv:function(A,E,I){var D=A/this.radius,H=E/this.radius,B=0,J=I*this.radDeg,F=33*this.radDeg,M=45*this.radDeg,N=Math.log(Math.cos(F)*(1/Math.cos(M)))/Math.log(Math.tan(Math.PI/4+M/2)*(1/Math.tan(Math.PI/4+F/2))),K=Math.cos(F)*Math.pow(Math.tan(Math.PI/4+F/2),N)/N,L=K*Math.pow(1/Math.tan(Math.PI/4+B/2),N),G=this.sgn(N)*Math.sqrt(D*D+(L-H)*(L-H)),C=Math.atan(D/(L-H));return{lat:(2*Math.atan(Math.pow(K/G,1/N))-Math.PI/2)*this.degRad,lng:(J+C/N)*this.degRad}}},jvm.WorldMap=function(A){var C=this,B;this.params=jvm.$.extend(!0,{},jvm.WorldMap.defaultParams,A);if(!jvm.WorldMap.maps[this.params.map]){throw new Error("Attempt to use map which was not loaded: "+this.params.map)}this.mapData=jvm.WorldMap.maps[this.params.map],this.markers={},this.regions={},this.regionsColors={},this.regionsData={},this.container=jvm.$("<div>").css({width:"100%",height:"100%"}).addClass("jvectormap-container"),this.params.container.append(this.container),this.container.data("mapObject",this),this.container.css({position:"relative",overflow:"hidden"}),this.defaultWidth=this.mapData.width,this.defaultHeight=this.mapData.height,this.setBackgroundColor(this.params.backgroundColor),this.onResize=function(){C.setSize()},jvm.$(window).resize(this.onResize);for(B in jvm.WorldMap.apiEvents){this.params[B]&&this.container.bind(jvm.WorldMap.apiEvents[B]+".jvectormap",this.params[B])}this.canvas=new jvm.VectorCanvas(this.container[0],this.width,this.height),"ontouchstart" in window||window.DocumentTouch&&document instanceof DocumentTouch?this.params.bindTouchEvents&&this.bindContainerTouchEvents():this.bindContainerEvents(),this.bindElementEvents(),this.createLabel(),this.params.zoomButtons&&this.bindZoomButtons(),this.createRegions(),this.createMarkers(this.params.markers||{}),this.setSize(),this.params.focusOn&&(typeof this.params.focusOn=="object"?this.setFocus.call(this,this.params.focusOn.scale,this.params.focusOn.x,this.params.focusOn.y):this.setFocus.call(this,this.params.focusOn)),this.params.selectedRegions&&this.setSelectedRegions(this.params.selectedRegions),this.params.selectedMarkers&&this.setSelectedMarkers(this.params.selectedMarkers),this.params.series&&this.createSeries()},jvm.WorldMap.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,setBackgroundColor:function(A){this.container.css("background-color",A)},resize:function(){var A=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/A,this.transX*=this.baseScale/A,this.transY*=this.baseScale/A},setSize:function(){this.width=this.container.width(),this.height=this.container.height(),this.resize(),this.canvas.setSize(this.width,this.height),this.applyTransform()},reset:function(){var A,B;for(A in this.series){for(B=0;B<this.series[A].length;B++){this.series[A][B].clear()}}this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform()},applyTransform:function(){var B,D,C,A;this.defaultWidth*this.scale<=this.width?(B=(this.width-this.defaultWidth*this.scale)/(2*this.scale),C=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(B=0,C=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(D=(this.height-this.defaultHeight*this.scale)/(2*this.scale),A=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(D=0,A=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>D?this.transY=D:this.transY<A&&(this.transY=A),this.transX>B?this.transX=B:this.transX<C&&(this.transX=C),this.canvas.applyTransformParams(this.scale,this.transX,this.transY),this.markers&&this.repositionMarkers(),this.container.trigger("viewportChange",[this.scale/this.baseScale,this.transX,this.transY])},bindContainerEvents:function(){var B=!1,D,C,A=this;this.container.mousemove(function(E){return B&&(A.transX-=(D-E.pageX)/A.scale,A.transY-=(C-E.pageY)/A.scale,A.applyTransform(),D=E.pageX,C=E.pageY),!1}).mousedown(function(E){return B=!0,D=E.pageX,C=E.pageY,!1}),jvm.$("body").mouseup(function(){B=!1}),this.params.zoomOnScroll&&this.container.mousewheel(function(E,G,J,I){var F=jvm.$(A.container).offset(),K=E.pageX-F.left,H=E.pageY-F.top,L=Math.pow(1.3,I);A.label.hide(),A.setScale(A.scale*L,K,H),E.preventDefault()})},bindContainerTouchEvents:function(){var A,D,G=this,C,F,B,H,E,I=function(N){var O=N.originalEvent.touches,L,M,J,K;N.type=="touchstart"&&(E=0),O.length==1?(E==1&&(J=G.transX,K=G.transY,G.transX-=(C-O[0].pageX)/G.scale,G.transY-=(F-O[0].pageY)/G.scale,G.applyTransform(),G.label.hide(),(J!=G.transX||K!=G.transY)&&N.preventDefault()),C=O[0].pageX,F=O[0].pageY):O.length==2&&(E==2?(M=Math.sqrt(Math.pow(O[0].pageX-O[1].pageX,2)+Math.pow(O[0].pageY-O[1].pageY,2))/D,G.setScale(A*M,B,H),G.label.hide(),N.preventDefault()):(L=jvm.$(G.container).offset(),O[0].pageX>O[1].pageX?B=O[1].pageX+(O[0].pageX-O[1].pageX)/2:B=O[0].pageX+(O[1].pageX-O[0].pageX)/2,O[0].pageY>O[1].pageY?H=O[1].pageY+(O[0].pageY-O[1].pageY)/2:H=O[0].pageY+(O[1].pageY-O[0].pageY)/2,B-=L.left,H-=L.top,A=G.scale,D=Math.sqrt(Math.pow(O[0].pageX-O[1].pageX,2)+Math.pow(O[0].pageY-O[1].pageY,2)))),E=O.length};jvm.$(this.container).bind("touchstart",I),jvm.$(this.container).bind("touchmove",I)},bindElementEvents:function(){var A=this,B;this.container.mousemove(function(){B=!0}),this.container.delegate("[class~='jvectormap-element']","mouseover mouseout",function(E){var H=this,C=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),G=C.indexOf("jvectormap-region")===-1?"marker":"region",D=G=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),I=G=="region"?A.regions[D].element:A.markers[D].element,F=G=="region"?A.mapData.paths[D].name:A.markers[D].config.name||"",J=jvm.$.Event(G+"LabelShow.jvectormap"),K=jvm.$.Event(G+"Over.jvectormap");E.type=="mouseover"?(A.container.trigger(K,[D]),K.isDefaultPrevented()||I.setHovered(!0),A.label.text(F),A.container.trigger(J,[A.label,D]),J.isDefaultPrevented()||(A.label.show(),A.labelWidth=A.label.width(),A.labelHeight=A.label.height())):(I.setHovered(!1),A.label.hide(),A.container.trigger(G+"Out.jvectormap",[D]))}),this.container.delegate("[class~='jvectormap-element']","mousedown",function(C){B=!1}),this.container.delegate("[class~='jvectormap-element']","mouseup",function(D){var C=this,E=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),F=E.indexOf("jvectormap-region")===-1?"marker":"region",G=F=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),H=jvm.$.Event(F+"Click.jvectormap"),I=F=="region"?A.regions[G].element:A.markers[G].element;if(!B){A.container.trigger(H,[G]);if(F==="region"&&A.params.regionsSelectable||F==="marker"&&A.params.markersSelectable){H.isDefaultPrevented()||(A.params[F+"sSelectableOne"]&&A.clearSelected(F+"s"),I.setSelected(!I.isSelected))}}})},bindZoomButtons:function(){var A=this;jvm.$("<div/>").addClass("jvectormap-zoomin").text("+").appendTo(this.container),jvm.$("<div/>").addClass("jvectormap-zoomout").html("&#x2212;").appendTo(this.container),this.container.find(".jvectormap-zoomin").click(function(){A.setScale(A.scale*A.params.zoomStep,A.width/2,A.height/2)}),this.container.find(".jvectormap-zoomout").click(function(){A.setScale(A.scale/A.params.zoomStep,A.width/2,A.height/2)})},createLabel:function(){var A=this;this.label=jvm.$("<div/>").addClass("jvectormap-label").appendTo(jvm.$("body")),this.container.mousemove(function(D){var C=D.pageX-15-A.labelWidth,B=D.pageY-15-A.labelHeight;C<5&&(C=D.pageX+15),B<5&&(B=D.pageY+15),A.label.is(":visible")&&A.label.css({left:C,top:B})})},setScale:function(B,F,C,A){var D,E=jvm.$.Event("zoom.jvectormap");B>this.params.zoomMax*this.baseScale?B=this.params.zoomMax*this.baseScale:B<this.params.zoomMin*this.baseScale&&(B=this.params.zoomMin*this.baseScale),typeof F!="undefined"&&typeof C!="undefined"&&(D=B/this.scale,A?(this.transX=F+this.defaultWidth*(this.width/(this.defaultWidth*B))/2,this.transY=C+this.defaultHeight*(this.height/(this.defaultHeight*B))/2):(this.transX-=(D-1)/B*F,this.transY-=(D-1)/B*C)),this.scale=B,this.applyTransform(),this.container.trigger(E,[B/this.baseScale])},setFocus:function(A,D,G){var C,F,B,H,E;if(jvm.$.isArray(A)||this.regions[A]){jvm.$.isArray(A)?H=A:H=[A];for(E=0;E<H.length;E++){this.regions[H[E]]&&(F=this.regions[H[E]].element.getBBox(),F&&(typeof C=="undefined"?C=F:(B={x:Math.min(C.x,F.x),y:Math.min(C.y,F.y),width:Math.max(C.x+C.width,F.x+F.width)-Math.min(C.x,F.x),height:Math.max(C.y+C.height,F.y+F.height)-Math.min(C.y,F.y)},C=B)))}this.setScale(Math.min(this.width/C.width,this.height/C.height),-(C.x+C.width/2),-(C.y+C.height/2),!0)}else{A*=this.baseScale,this.setScale(A,-D*this.defaultWidth,-G*this.defaultHeight,!0)}},getSelected:function(A){var C,B=[];for(C in this[A]){this[A][C].element.isSelected&&B.push(C)}return B},getSelectedRegions:function(){return this.getSelected("regions")},getSelectedMarkers:function(){return this.getSelected("markers")},setSelected:function(A,C){var B;typeof C!="object"&&(C=[C]);if(jvm.$.isArray(C)){for(B=0;B<C.length;B++){this[A][C[B]].element.setSelected(!0)}}else{for(B in C){this[A][B].element.setSelected(!!C[B])}}},setSelectedRegions:function(A){this.setSelected("regions",A)},setSelectedMarkers:function(A){this.setSelected("markers",A)},clearSelected:function(B){var D={},C=this.getSelected(B),A;for(A=0;A<C.length;A++){D[C[A]]=!1}this.setSelected(B,D)},clearSelectedRegions:function(){this.clearSelected("regions")},clearSelectedMarkers:function(){this.clearSelected("markers")},getMapObject:function(){return this},getRegionName:function(A){return this.mapData.paths[A].name},createRegions:function(){var A,C,B=this;for(A in this.mapData.paths){C=this.canvas.addPath({d:this.mapData.paths[A].path,"data-code":A},jvm.$.extend(!0,{},this.params.regionStyle)),jvm.$(C.node).bind("selected",function(D,E){B.container.trigger("regionSelected.jvectormap",[jvm.$(this).attr("data-code"),E,B.getSelectedRegions()])}),C.addClass("jvectormap-region jvectormap-element"),this.regions[A]={element:C,config:this.mapData.paths[A]}}},createMarkers:function(B){var G,C,A,D,E,F=this;this.markersGroup=this.markersGroup||this.canvas.addGroup();if(jvm.$.isArray(B)){E=B.slice(),B={};for(G=0;G<E.length;G++){B[G]=E[G]}}for(G in B){D=B[G] instanceof Array?{latLng:B[G]}:B[G],A=this.getMarkerPosition(D),A!==!1&&(C=this.canvas.addCircle({"data-index":G,cx:A.x,cy:A.y},jvm.$.extend(!0,{},this.params.markerStyle,{initial:D.style||{}}),this.markersGroup),C.addClass("jvectormap-marker jvectormap-element"),jvm.$(C.node).bind("selected",function(H,I){F.container.trigger("markerSelected.jvectormap",[jvm.$(this).attr("data-index"),I,F.getSelectedMarkers()])}),this.markers[G]&&this.removeMarkers([G]),this.markers[G]={element:C,config:D})}},repositionMarkers:function(){var A,B;for(A in this.markers){B=this.getMarkerPosition(this.markers[A].config),B!==!1&&this.markers[A].element.setStyle({cx:B.x,cy:B.y})}},getMarkerPosition:function(A){return jvm.WorldMap.maps[this.params.map].projection?this.latLngToPoint.apply(this,A.latLng||[0,0]):{x:A.coords[0]*this.scale+this.transX*this.scale,y:A.coords[1]*this.scale+this.transY*this.scale}},addMarker:function(B,G,C){var A={},D=[],E,F,C=C||[];A[B]=G;for(F=0;F<C.length;F++){E={},E[B]=C[F],D.push(E)}this.addMarkers(A,D)},addMarkers:function(A,C){var B;C=C||[],this.createMarkers(A);for(B=0;B<C.length;B++){this.series.markers[B].setValues(C[B]||{})}},removeMarkers:function(A){var B;for(B=0;B<A.length;B++){this.markers[A[B]].element.remove(),delete this.markers[A[B]]}},removeAllMarkers:function(){var A,B=[];for(A in this.markers){B.push(A)}this.removeMarkers(B)},latLngToPoint:function(A,D){var G,C=jvm.WorldMap.maps[this.params.map].projection,F=C.centralMeridian,B=this.width-this.baseTransX*2*this.baseScale,H=this.height-this.baseTransY*2*this.baseScale,E,I,J=this.scale/this.baseScale;return D<-180+F&&(D+=360),G=jvm.Proj[C.type](A,D,F),E=this.getInsetForPoint(G.x,G.y),E?(I=E.bbox,G.x=(G.x-I[0].x)/(I[1].x-I[0].x)*E.width*this.scale,G.y=(G.y-I[0].y)/(I[1].y-I[0].y)*E.height*this.scale,{x:G.x+this.transX*this.scale+E.left*this.scale,y:G.y+this.transY*this.scale+E.top*this.scale}):!1},pointToLatLng:function(A,D){var G=jvm.WorldMap.maps[this.params.map].projection,C=G.centralMeridian,F=jvm.WorldMap.maps[this.params.map].insets,B,H,E,I,J;for(B=0;B<F.length;B++){H=F[B],E=H.bbox,I=A-(this.transX*this.scale+H.left*this.scale),J=D-(this.transY*this.scale+H.top*this.scale),I=I/(H.width*this.scale)*(E[1].x-E[0].x)+E[0].x,J=J/(H.height*this.scale)*(E[1].y-E[0].y)+E[0].y;if(I>E[0].x&&I<E[1].x&&J>E[0].y&&J<E[1].y){return jvm.Proj[G.type+"_inv"](I,-J,C)}}return !1},getInsetForPoint:function(B,E){var C=jvm.WorldMap.maps[this.params.map].insets,A,D;for(A=0;A<C.length;A++){D=C[A].bbox;if(B>D[0].x&&B<D[1].x&&E>D[0].y&&E<D[1].y){return C[A]}}},createSeries:function(){var A,B;this.series={markers:[],regions:[]};for(B in this.params.series){for(A=0;A<this.params.series[B].length;A++){this.series[B][A]=new jvm.DataSeries(this.params.series[B][A],this[B])}}},remove:function(){this.label.remove(),this.container.remove(),jvm.$(window).unbind("resize",this.onResize)}},jvm.WorldMap.maps={},jvm.WorldMap.defaultParams={map:"world_mill_en",backgroundColor:"#505050",zoomButtons:!0,zoomOnScroll:!0,zoomMax:8,zoomMin:1,zoomStep:1.6,regionsSelectable:!1,markersSelectable:!1,bindTouchEvents:!0,regionStyle:{initial:{fill:"white","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":0.8},selected:{fill:"yellow"},selectedHover:{}},markerStyle:{initial:{fill:"grey",stroke:"#505050","fill-opacity":1,"stroke-width":1,"stroke-opacity":1,r:5},hover:{stroke:"black","stroke-width":2},selected:{fill:"blue"},selectedHover:{}}},jvm.WorldMap.apiEvents={onRegionLabelShow:"regionLabelShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onRegionSelected:"regionSelected",onMarkerLabelShow:"markerLabelShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick",onMarkerSelected:"markerSelected",onViewportChange:"viewportChange"};