(function(C,A,B){(function(D){typeof define=="function"&&define.amd?define(["jquery"],D):jQuery&&!jQuery.fn.sparkline&&D(jQuery)})(function(Ar){var M={},Ap,Aq,Aj,Ak,Ah,Ai,An,Ao,Al,Am,Ab,Ac,c,Aa,Af,Ag,Ad,Ae,a,b,Z,U,S,T,X,Y,V,W,P,Q,N,O,R=0;Ap=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:B,normalRangeMax:B,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:B,chartRangeMax:B,chartRangeMinX:B,chartRangeMaxX:B,tooltipFormat:new Aj('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:B,nullColor:B,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:B,chartRangeMin:B,chartRangeClip:!1,colorMap:B,tooltipFormat:new Aj('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new Aj('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:B,thresholdValue:0,chartRangeMax:B,chartRangeMin:B,chartRangeClip:!1,tooltipFormat:new Aj("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:B,tooltipFormat:new Aj("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new Aj('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:B,targetColor:"#4a2",chartRangeMax:B,chartRangeMin:B,tooltipFormat:new Aj("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},Y='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',Aq=function(){var E,D;return E=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(E.prototype=Ar.extend(new arguments[0],arguments[arguments.length-1]),E._super=arguments[0].prototype):E.prototype=arguments[arguments.length-1],arguments.length>2&&(D=Array.prototype.slice.call(arguments,1,-1),D.unshift(E.prototype),Ar.extend.apply(Ar,D))):E.prototype=arguments[0],E.prototype.cls=E,E},Ar.SPFormatClass=Aj=Aq({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(E,D){this.format=E,this.fclass=D},render:function(J,I,l){var D=this,K=J,L,G,H,E,F;return this.format.replace(this.fre,function(){var d;return G=arguments[1],H=arguments[3],L=D.precre.exec(G),L?(F=L[2],G=L[1]):F=!1,E=K[G],E===B?"":H&&I&&I[H]?(d=I[H],d.get?I[H].get(E)||E:I[H][E]||E):(Al(E)&&(l.get("numberFormatter")?E=l.get("numberFormatter")(E):E=Aa(E,F,l.get("numberDigitGroupCount"),l.get("numberDigitGroupSep"),l.get("numberDecimalMark"))),E)})}}),Ar.spformat=function(E,D){return new Aj(E,D)},Ak=function(F,D,E){return F<D?D:F>E?E:F},Ah=function(F,E){var D;return E===2?(D=A.floor(F.length/2),F.length%2?F[D]:(F[D-1]+F[D])/2):F.length%2?(D=(F.length*E+E)/4,D%1?(F[A.floor(D)]+F[A.floor(D)-1])/2:F[D-1]):(D=(F.length*E+2)/4,D%1?(F[A.floor(D)]+F[A.floor(D)-1])/2:F[D-1])},Ai=function(E){var D;switch(E){case"undefined":E=B;break;case"null":E=null;break;case"true":E=!0;break;case"false":E=!1;break;default:D=parseFloat(E),E==D&&(E=D)}return E},An=function(F){var D,E=[];for(D=F.length;D--;){E[D]=Ai(F[D])}return E},Ao=function(H,F){var G,D,E=[];for(G=0,D=H.length;G<D;G++){H[G]!==F&&E.push(H[G])}return E},Al=function(D){return !isNaN(parseFloat(D))&&isFinite(D)},Aa=function(I,G,H,F,J){var D,E;I=(G===!1?parseFloat(I).toString():I.toFixed(G)).split(""),D=(D=Ar.inArray(".",I))<0?I.length:D,D<I.length&&(I[D]=J);for(E=D-H;E>0;E-=H){I.splice(E,0,F)}return I.join("")},Am=function(G,E,F){var D;for(D=E.length;D--;){if(F&&E[D]===null){continue}if(E[D]!==G){return !1}}return !0},Ab=function(F){var D=0,E;for(E=F.length;E--;){D+=typeof F[E]=="number"?F[E]:0}return D},c=function(D){return Ar.isArray(D)?D:[D]},Ac=function(D){var E;C.createStyleSheet?C.createStyleSheet().cssText=D:(E=C.createElement("style"),E.type="text/css",C.getElementsByTagName("head")[0].appendChild(E),E[typeof C.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=D)},Ar.fn.simpledraw=function(H,F,J,D){var E,G;if(J&&(E=this.data("_jqs_vcanvas"))){return E}if(Ar.fn.sparkline.canvas===!1){return !1}if(Ar.fn.sparkline.canvas===B){var I=C.createElement("canvas");if(!I.getContext||!I.getContext("2d")){if(!C.namespaces||!!C.namespaces.v){return Ar.fn.sparkline.canvas=!1,!1}C.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),Ar.fn.sparkline.canvas=function(f,L,e,K){return new N(f,L,e)}}else{Ar.fn.sparkline.canvas=function(f,L,e,K){return new Q(f,L,e,K)}}}return H===B&&(H=Ar(this).innerWidth()),F===B&&(F=Ar(this).innerHeight()),E=Ar.fn.sparkline.canvas(H,F,this,D),G=Ar(this).data("_jqs_mhandler"),G&&G.registerCanvas(E),E},Ar.fn.cleardraw=function(){var D=this.data("_jqs_vcanvas");D&&D.reset()},Ar.RangeMapClass=Af=Aq({init:function(G){var E,F,D=[];for(E in G){G.hasOwnProperty(E)&&typeof E=="string"&&E.indexOf(":")>-1&&(F=E.split(":"),F[0]=F[0].length===0?-Infinity:parseFloat(F[0]),F[1]=F[1].length===0?Infinity:parseFloat(F[1]),F[2]=G[E],D.push(F))}this.map=G,this.rangelist=D||!1},get:function(G){var F=this.rangelist,D,E,H;if((H=this.map[G])!==B){return H}if(F){for(D=F.length;D--;){E=F[D];if(E[0]<=G&&E[1]>=G){return E[2]}}}return B}}),Ar.range_map=function(D){return new Af(D)},Ag=Aq({init:function(F,D){var E=Ar(F);this.$el=E,this.options=D,this.currentPageX=0,this.currentPageY=0,this.el=F,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!D.get("disableTooltips"),this.highlightEnabled=!D.get("disableHighlight")},registerSparkline:function(D){this.splist.push(D),this.over&&this.updateDisplay()},registerCanvas:function(E){var D=Ar(E.canvas);this.canvas=E,this.$canvas=D,D.mouseenter(Ar.proxy(this.mouseenter,this)),D.mouseleave(Ar.proxy(this.mouseleave,this)),D.click(Ar.proxy(this.mouseclick,this))},reset:function(D){this.splist=[],this.tooltip&&D&&(this.tooltip.remove(),this.tooltip=B)},mouseclick:function(E){var D=Ar.Event("sparklineClick");D.originalEvent=E,D.sparklines=this.splist,this.$el.trigger(D)},mouseenter:function(D){Ar(C.body).unbind("mousemove.jqs"),Ar(C.body).bind("mousemove.jqs",Ar.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=D.pageX,this.currentPageY=D.pageY,this.currentEl=D.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new Ad(this.options),this.tooltip.updatePosition(D.pageX,D.pageY)),this.updateDisplay()},mouseleave:function(){Ar(C.body).unbind("mousemove.jqs");var F=this.splist,G=F.length,E=!1,H,D;this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(D=0;D<G;D++){H=F[D],H.clearRegionHighlight()&&(E=!0)}E&&this.canvas.render()},mousemove:function(D){this.currentPageX=D.pageX,this.currentPageY=D.pageY,this.currentEl=D.target,this.tooltip&&this.tooltip.updatePosition(D.pageX,D.pageY),this.updateDisplay()},updateDisplay:function(){var L=this.splist,J=L.length,K=!1,D=this.$canvas.offset(),d=this.currentPageX-D.left,m=this.currentPageY-D.top,G,H,E,F,I;if(!this.over){return}for(E=0;E<J;E++){H=L[E],F=H.setRegionHighlight(this.currentEl,d,m),F&&(K=!0)}if(K){I=Ar.Event("sparklineRegionChange"),I.sparklines=this.splist,this.$el.trigger(I);if(this.tooltip){G="";for(E=0;E<J;E++){H=L[E],G+=H.getCurrentRegionTooltip()}this.tooltip.setContent(G)}this.disableHighlight||this.canvas.render()}F===null&&this.mouseleave()}}),Ad=Aq({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(E){var F=E.get("tooltipClassname","jqstooltip"),D=this.sizeStyle,G;this.container=E.get("tooltipContainer")||C.body,this.tooltipOffsetX=E.get("tooltipOffsetX",10),this.tooltipOffsetY=E.get("tooltipOffsetY",12),Ar("#jqssizetip").remove(),Ar("#jqstooltip").remove(),this.sizetip=Ar("<div/>",{id:"jqssizetip",style:D,"class":F}),this.tooltip=Ar("<div/>",{id:"jqstooltip","class":F}).appendTo(this.container),G=this.tooltip.offset(),this.offsetLeft=G.left,this.offsetTop=G.top,this.hidden=!0,Ar(window).unbind("resize.jqs scroll.jqs"),Ar(window).bind("resize.jqs scroll.jqs",Ar.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=Ar(window).scrollTop(),this.scrollLeft=Ar(window).scrollLeft(),this.scrollRight=this.scrollLeft+Ar(window).width(),this.updatePosition()},getSize:function(D){this.sizetip.html(D).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(D){if(!D){this.tooltip.css("visibility","hidden"),this.hidden=!0;return}this.getSize(D),this.tooltip.html(D).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(E,D){if(E===B){if(this.mousex===B){return}E=this.mousex-this.offsetLeft,D=this.mousey-this.offsetTop}else{this.mousex=E-=this.offsetLeft,this.mousey=D-=this.offsetTop}if(!this.height||!this.width||this.hidden){return}D-=this.height+this.tooltipOffsetY,E+=this.tooltipOffsetX,D<this.scrollTop&&(D=this.scrollTop),E<this.scrollLeft?E=this.scrollLeft:E+this.width>this.scrollRight&&(E=this.scrollRight-this.width),this.tooltip.css({left:E,top:D})},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=B,Ar(window).unbind("resize.jqs scroll.jqs")}}),V=function(){Ac(Y)},Ar(V),O=[],Ar.fn.sparkline=function(E,D){return this.each(function(){var I=new Ar.fn.sparkline.options(this,D),F=Ar(this),G,H;G=function(){var L,J,K,g,n,d,f;if(E==="html"||E===B){f=this.getAttribute(I.get("tagValuesAttribute"));if(f===B||f===null){f=F.html()}L=f.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{L=E}J=I.get("width")==="auto"?L.length*I.get("defaultPixelsPerValue"):I.get("width");if(I.get("height")==="auto"){if(!I.get("composite")||!Ar.data(this,"_jqs_vcanvas")){g=C.createElement("span"),g.innerHTML="a",F.html(g),K=Ar(g).innerHeight()||Ar(g).height(),Ar(g).remove(),g=null}}else{K=I.get("height")}I.get("disableInteraction")?n=!1:(n=Ar.data(this,"_jqs_mhandler"),n?I.get("composite")||n.reset():(n=new Ag(this,I),Ar.data(this,"_jqs_mhandler",n)));if(I.get("composite")&&!Ar.data(this,"_jqs_vcanvas")){Ar.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),Ar.data(this,"_jqs_errnotify",!0));return}d=new (Ar.fn.sparkline[I.get("type")])(this,L,I,J,K),d.render(),n&&n.registerSparkline(d)};if(Ar(this).html()&&!I.get("disableHiddenCheck")&&Ar(this).is(":hidden")||!Ar(this).parents("body").length){if(!I.get("composite")&&Ar.data(this,"_jqs_pending")){for(H=O.length;H;H--){O[H-1][0]==this&&O.splice(H-1,1)}}O.push([this,G]),Ar.data(this,"_jqs_pending",!0)}else{G.call(this)}})},Ar.fn.sparkline.defaults=Ap(),Ar.sparkline_display_visible=function(){var G,E,F,D=[];for(E=0,F=O.length;E<F;E++){G=O[E][0],Ar(G).is(":visible")&&!Ar(G).parents().is(":hidden")?(O[E][1].call(G),Ar.data(O[E][0],"_jqs_pending",!1),D.push(E)):!Ar(G).closest("html").length&&!Ar.data(G,"_jqs_pending")&&(Ar.data(O[E][0],"_jqs_pending",!1),D.push(E))}for(E=D.length;E;E--){O.splice(D[E-1],1)}},Ar.fn.sparkline.options=Aq({init:function(H,F){var G,I,D,E;this.userOptions=F=F||{},this.tag=H,this.tagValCache={},I=Ar.fn.sparkline.defaults,D=I.common,this.tagOptionsPrefix=F.enableTagOptions&&(F.tagOptionsPrefix||D.tagOptionsPrefix),E=this.getTagSetting("type"),E===M?G=I[F.type||D.type]:G=I[E],this.mergedOptions=Ar.extend({},D,G,F)},getTagSetting:function(H){var G=this.tagOptionsPrefix,E,I,D,F;if(G===!1||G===B){return M}if(this.tagValCache.hasOwnProperty(H)){E=this.tagValCache.key}else{E=this.tag.getAttribute(G+H);if(E===B||E===null){E=M}else{if(E.substr(0,1)==="["){E=E.substr(1,E.length-2).split(",");for(I=E.length;I--;){E[I]=Ai(E[I].replace(/(^\s*)|(\s*$)/g,""))}}else{if(E.substr(0,1)==="{"){D=E.substr(1,E.length-2).split(","),E={};for(I=D.length;I--;){F=D[I].split(":",2),E[F[0].replace(/(^\s*)|(\s*$)/g,"")]=Ai(F[1].replace(/(^\s*)|(\s*$)/g,""))}}else{E=Ai(E)}}}this.tagValCache.key=E}return E},get:function(F,E){var D=this.getTagSetting(F),G;return D!==M?D:(G=this.mergedOptions[F])===B?E:G}}),Ar.fn.sparkline._base=Aq({disabled:!1,init:function(G,F,E,H,D){this.el=G,this.$el=Ar(G),this.values=F,this.options=E,this.width=H,this.height=D,this.currentRegion=B},initTarget:function(){var D=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),D))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(E,D){},setRegionHighlight:function(H,G,E){var F=this.currentRegion,I=!this.options.get("disableHighlight"),D;return G>this.canvasWidth||E>this.canvasHeight||G<0||E<0?null:(D=this.getRegion(H,G,E),F!==D?(F!==B&&I&&this.removeHighlight(),this.currentRegion=D,D!==B&&I&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==B?(this.removeHighlight(),this.currentRegion=B,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(D){},getCurrentRegionTooltip:function(){var w=this.options,v="",z=[],x,y,K,I,J,h,u,L,d,F,G,D,E,H;if(this.currentRegion===B){return""}x=this.getCurrentRegionFields(),G=w.get("tooltipFormatter");if(G){return G(this,w,x)}w.get("tooltipChartTitle")&&(v+='<div class="jqs jqstitle">'+w.get("tooltipChartTitle")+"</div>\n"),y=this.options.get("tooltipFormat");if(!y){return""}Ar.isArray(y)||(y=[y]),Ar.isArray(x)||(x=[x]),u=this.options.get("tooltipFormatFieldlist"),L=this.options.get("tooltipFormatFieldlistKey");if(u&&L){d=[];for(h=x.length;h--;){F=x[h][L],(H=Ar.inArray(F,u))!=-1&&(d[H]=x[h])}x=d}K=y.length,E=x.length;for(h=0;h<K;h++){D=y[h],typeof D=="string"&&(D=new Aj(D)),I=D.fclass||"jqsfield";for(H=0;H<E;H++){if(!x[H].isNull||!w.get("tooltipSkipNull")){Ar.extend(x[H],{prefix:w.get("tooltipPrefix"),suffix:w.get("tooltipSuffix")}),J=D.render(x[H],w.get("tooltipValueLookups"),w),z.push('<div class="'+I+'">'+J+"</div>")}}}return z.length?v+z.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(H,G){var K=G.get("highlightColor"),D=G.get("highlightLighten"),I,J,F,E;if(K){return K}if(D){I=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(H)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(H);if(I){F=[],J=H.length===4?16:1;for(E=0;E<3;E++){F[E]=Ak(A.round(parseInt(I[E+1],16)*J*D),0,255)}return"rgb("+F.join(",")+")"}}return H}}),Ae={changeHighlight:function(G){var E=this.currentRegion,F=this.target,D=this.regionShapes[E],H;D&&(H=this.renderRegion(E,G),Ar.isArray(H)||Ar.isArray(D)?(F.replaceWithShapes(D,H),this.regionShapes[E]=Ar.map(H,function(I){return I.id})):(F.replaceWithShape(D,H),this.regionShapes[E]=H.id))},render:function(){var I=this.values,G=this.target,H=this.regionShapes,F,J,D,E;if(!this.cls._super.render.call(this)){return}for(D=I.length;D--;){F=this.renderRegion(D);if(F){if(Ar.isArray(F)){J=[];for(E=F.length;E--;){F[E].append(),J.push(F[E].id)}H[D]=J}else{F.append(),H[D]=F.id}}else{H[D]=null}}G.render()}},Ar.fn.sparkline.line=a=Aq(Ar.fn.sparkline._base,{type:"line",init:function(H,F,G,D,E){a._super.init.call(this,H,F,G,D,E),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(G,F,D){var E,H=this.regionMap;for(E=H.length;E--;){if(H[E]!==null&&F>=H[E][0]&&F<=H[E][1]){return H[E][2]}}return B},getCurrentRegionFields:function(){var D=this.currentRegion;return{isNull:this.yvalues[D]===null,x:this.xvalues[D],y:this.yvalues[D],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:D}},renderHighlight:function(){var I=this.currentRegion,H=this.target,L=this.vertices[I],D=this.options,J=D.get("spotRadius"),K=D.get("highlightSpotColor"),F=D.get("highlightLineColor"),G,E;if(!L){return}J&&K&&(G=H.drawCircle(L[0],L[1],J,B,K),this.highlightSpotId=G.id,H.insertAfterShape(this.lastShapeId,G)),F&&(E=H.drawLine(L[0],this.canvasTop,L[0],this.canvasTop+this.canvasHeight,F),this.highlightLineId=E.id,H.insertAfterShape(this.lastShapeId,E))},removeHighlight:function(){var D=this.target;this.highlightSpotId&&(D.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(D.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var J=this.values,I=J.length,l=this.xvalues,D=this.yvalues,K=this.yminmax,L,G,H,E,F;for(L=0;L<I;L++){G=J[L],H=typeof J[L]=="string",E=typeof J[L]=="object"&&J[L] instanceof Array,F=H&&J[L].split(":"),H&&F.length===2?(l.push(Number(F[0])),D.push(Number(F[1])),K.push(Number(F[1]))):E?(l.push(G[0]),D.push(G[1]),K.push(G[1])):(l.push(L),J[L]===null||J[L]==="null"?D.push(null):(D.push(Number(G)),K.push(Number(G))))}this.options.get("xvalues")&&(l=this.options.get("xvalues")),this.maxy=this.maxyorg=A.max.apply(A,K),this.miny=this.minyorg=A.min.apply(A,K),this.maxx=A.max.apply(A,l),this.minx=A.min.apply(A,l),this.xvalues=l,this.yvalues=D,this.yminmax=K},processRangeOptions:function(){var F=this.options,E=F.get("normalRangeMin"),D=F.get("normalRangeMax");E!==B&&(E<this.miny&&(this.miny=E),D>this.maxy&&(this.maxy=D)),F.get("chartRangeMin")!==B&&(F.get("chartRangeClip")||F.get("chartRangeMin")<this.miny)&&(this.miny=F.get("chartRangeMin")),F.get("chartRangeMax")!==B&&(F.get("chartRangeClip")||F.get("chartRangeMax")>this.maxy)&&(this.maxy=F.get("chartRangeMax")),F.get("chartRangeMinX")!==B&&(F.get("chartRangeClipX")||F.get("chartRangeMinX")<this.minx)&&(this.minx=F.get("chartRangeMinX")),F.get("chartRangeMaxX")!==B&&(F.get("chartRangeClipX")||F.get("chartRangeMaxX")>this.maxx)&&(this.maxx=F.get("chartRangeMaxX"))},drawNormalRange:function(I,L,D,J,K){var G=this.options.get("normalRangeMin"),H=this.options.get("normalRangeMax"),E=L+A.round(D-D*((H-this.miny)/K)),F=A.round(D*(H-G)/K);this.target.drawRect(I,E,J,F,B,this.options.get("normalRangeColor")).append()},render:function(){var AD=this.options,AG=this.target,AE=this.canvasWidth,AF=this.canvasHeight,Ax=this.vertices,Ay=AD.get("spotRadius"),Av=this.regionMap,Aw,AB,AC,Az,AA,t,x,L,d,Au,As,At,AT,AR,AM,AK,AL,AP,AQ,AN,AO,AI,AJ,AS,AH;if(!a._super.render.call(this)){return}this.scanValues(),this.processRangeOptions(),AJ=this.xvalues,AS=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}Az=AA=0,Aw=this.maxx-this.minx===0?1:this.maxx-this.minx,AB=this.maxy-this.miny===0?1:this.maxy-this.miny,AC=this.yvalues.length-1,Ay&&(AE<Ay*4||AF<Ay*4)&&(Ay=0);if(Ay){AO=AD.get("highlightSpotColor")&&!AD.get("disableInteraction");if(AO||AD.get("minSpotColor")||AD.get("spotColor")&&AS[AC]===this.miny){AF-=A.ceil(Ay)}if(AO||AD.get("maxSpotColor")||AD.get("spotColor")&&AS[AC]===this.maxy){AF-=A.ceil(Ay),Az+=A.ceil(Ay)}if(AO||(AD.get("minSpotColor")||AD.get("maxSpotColor"))&&(AS[0]===this.miny||AS[0]===this.maxy)){AA+=A.ceil(Ay),AE-=A.ceil(Ay)}if(AO||AD.get("spotColor")||AD.get("minSpotColor")||AD.get("maxSpotColor")&&(AS[AC]===this.miny||AS[AC]===this.maxy)){AE-=A.ceil(Ay)}}AF--,AD.get("normalRangeMin")!==B&&!AD.get("drawNormalOnTop")&&this.drawNormalRange(AA,Az,AF,AE,AB),x=[],L=[x],AR=AM=null,AK=AS.length;for(AH=0;AH<AK;AH++){d=AJ[AH],As=AJ[AH+1],Au=AS[AH],At=AA+A.round((d-this.minx)*(AE/Aw)),AT=AH<AK-1?AA+A.round((As-this.minx)*(AE/Aw)):AE,AM=At+(AT-At)/2,Av[AH]=[AR||0,AM,AH],AR=AM,Au===null?AH&&(AS[AH-1]!==null&&(x=[],L.push(x)),Ax.push(null)):(Au<this.miny&&(Au=this.miny),Au>this.maxy&&(Au=this.maxy),x.length||x.push([At,Az+AF]),t=[At,Az+A.round(AF-AF*((Au-this.miny)/AB))],x.push(t),Ax.push(t))}AL=[],AP=[],AQ=L.length;for(AH=0;AH<AQ;AH++){x=L[AH],x.length&&(AD.get("fillColor")&&(x.push([x[x.length-1][0],Az+AF]),AP.push(x.slice(0)),x.pop()),x.length>2&&(x[0]=[x[0][0],x[1][1]]),AL.push(x))}AQ=AP.length;for(AH=0;AH<AQ;AH++){AG.drawShape(AP[AH],AD.get("fillColor"),AD.get("fillColor")).append()}AD.get("normalRangeMin")!==B&&AD.get("drawNormalOnTop")&&this.drawNormalRange(AA,Az,AF,AE,AB),AQ=AL.length;for(AH=0;AH<AQ;AH++){AG.drawShape(AL[AH],AD.get("lineColor"),B,AD.get("lineWidth")).append()}if(Ay&&AD.get("valueSpots")){AN=AD.get("valueSpots"),AN.get===B&&(AN=new Af(AN));for(AH=0;AH<AK;AH++){AI=AN.get(AS[AH]),AI&&AG.drawCircle(AA+A.round((AJ[AH]-this.minx)*(AE/Aw)),Az+A.round(AF-AF*((AS[AH]-this.miny)/AB)),Ay,B,AI).append()}}Ay&&AD.get("spotColor")&&AS[AC]!==null&&AG.drawCircle(AA+A.round((AJ[AJ.length-1]-this.minx)*(AE/Aw)),Az+A.round(AF-AF*((AS[AC]-this.miny)/AB)),Ay,B,AD.get("spotColor")).append(),this.maxy!==this.minyorg&&(Ay&&AD.get("minSpotColor")&&(d=AJ[Ar.inArray(this.minyorg,AS)],AG.drawCircle(AA+A.round((d-this.minx)*(AE/Aw)),Az+A.round(AF-AF*((this.minyorg-this.miny)/AB)),Ay,B,AD.get("minSpotColor")).append()),Ay&&AD.get("maxSpotColor")&&(d=AJ[Ar.inArray(this.maxyorg,AS)],AG.drawCircle(AA+A.round((d-this.minx)*(AE/Aw)),Az+A.round(AF-AF*((this.maxyorg-this.miny)/AB)),Ay,B,AD.get("maxSpotColor")).append())),this.lastShapeId=AG.getLastShapeId(),this.canvasTop=Az,AG.render()}}),Ar.fn.sparkline.bar=b=Aq(Ar.fn.sparkline._base,Ae,{type:"bar",init:function(AT,d,AU,AV,AQ){var AP=parseInt(AU.get("barWidth"),10),AR=parseInt(AU.get("barSpacing"),10),AS=AU.get("chartRangeMin"),AK=AU.get("chartRangeMax"),AL=AU.get("chartRangeClip"),AI=Infinity,AJ=-Infinity,AO,AM,AN,AH,AG,AB,Az,AA,AE,AF,AC,AD,At,Au,y,As,Ax,Ay,Av,Aw,l,m,i;b._super.init.call(this,AT,d,AU,AV,AQ);for(AB=0,Az=d.length;AB<Az;AB++){Aw=d[AB],AO=typeof Aw=="string"&&Aw.indexOf(":")>-1;if(AO||Ar.isArray(Aw)){y=!0,AO&&(Aw=d[AB]=An(Aw.split(":"))),Aw=Ao(Aw,null),AM=A.min.apply(A,Aw),AN=A.max.apply(A,Aw),AM<AI&&(AI=AM),AN>AJ&&(AJ=AN)}}this.stacked=y,this.regionShapes={},this.barWidth=AP,this.barSpacing=AR,this.totalBarWidth=AP+AR,this.width=AV=d.length*AP+(d.length-1)*AR,this.initTarget(),AL&&(At=AS===B?-Infinity:AS,Au=AK===B?Infinity:AK),AG=[],AH=y?[]:AG;var k=[],t=[];for(AB=0,Az=d.length;AB<Az;AB++){if(y){As=d[AB],d[AB]=Av=[],k[AB]=0,AH[AB]=t[AB]=0;for(Ax=0,Ay=As.length;Ax<Ay;Ax++){Aw=Av[Ax]=AL?Ak(As[Ax],At,Au):As[Ax],Aw!==null&&(Aw>0&&(k[AB]+=Aw),AI<0&&AJ>0?Aw<0?t[AB]+=A.abs(Aw):AH[AB]+=Aw:AH[AB]+=A.abs(Aw-(Aw<0?AJ:AI)),AG.push(Aw))}}else{Aw=AL?Ak(d[AB],At,Au):d[AB],Aw=d[AB]=Ai(Aw),Aw!==null&&AG.push(Aw)}}this.max=AD=A.max.apply(A,AG),this.min=AC=A.min.apply(A,AG),this.stackMax=AJ=y?A.max.apply(A,k):AD,this.stackMin=AI=y?A.min.apply(A,AG):AC,AU.get("chartRangeMin")!==B&&(AU.get("chartRangeClip")||AU.get("chartRangeMin")<AC)&&(AC=AU.get("chartRangeMin")),AU.get("chartRangeMax")!==B&&(AU.get("chartRangeClip")||AU.get("chartRangeMax")>AD)&&(AD=AU.get("chartRangeMax")),this.zeroAxis=AE=AU.get("zeroAxis",!0),AC<=0&&AD>=0&&AE?AF=0:AE==0?AF=AC:AC>0?AF=AC:AF=AD,this.xaxisOffset=AF,AA=y?A.max.apply(A,AH)+A.max.apply(A,t):AD-AC,this.canvasHeightEf=AE&&AC<0?this.canvasHeight-2:this.canvasHeight-1,AC<AF?(m=y&&AD>=0?AJ:AD,l=(m-AF)/AA*this.canvasHeight,l!==A.ceil(l)&&(this.canvasHeightEf-=2,l=A.ceil(l))):l=this.canvasHeight,this.yoffset=l,Ar.isArray(AU.get("colorMap"))?(this.colorMapByIndex=AU.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=AU.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===B&&(this.colorMapByValue=new Af(this.colorMapByValue))),this.range=AA},getRegion:function(F,D,E){var G=A.floor(D/this.totalBarWidth);return G<0||G>=this.values.length?B:G},getCurrentRegionFields:function(){var H=this.currentRegion,F=c(this.values[H]),G=[],D,E;for(E=F.length;E--;){D=F[E],G.push({isNull:D===null,value:D,color:this.calcColor(E,D,H),offset:H})}return G},calcColor:function(I,H,D){var J=this.colorMapByIndex,K=this.colorMapByValue,F=this.options,G,E;return this.stacked?G=F.get("stackedBarColor"):G=H<0?F.get("negBarColor"):F.get("barColor"),H===0&&F.get("zeroColor")!==B&&(G=F.get("zeroColor")),K&&(E=K.get(H))?G=E:J&&J.length>D&&(G=J[D]),Ar.isArray(G)?G[I%G.length]:G},renderRegion:function(Aw,Az){var Ax=this.values[Aw],Ay=this.options,o=this.xaxisOffset,As=[],L=this.range,d=this.stacked,Au=this.target,Av=Aw*this.totalBarWidth,At=this.canvasHeightEf,F=this.yoffset,G,D,E,J,K,H,I,AB,AC,AA;Ax=Ar.isArray(Ax)?Ax:[Ax],I=Ax.length,AB=Ax[0],J=Am(null,Ax),AA=Am(o,Ax,!0);if(J){return Ay.get("nullColor")?(E=Az?Ay.get("nullColor"):this.calcHighlightColor(Ay.get("nullColor"),Ay),G=F>0?F-1:F,Au.drawRect(Av,G,this.barWidth-1,0,E,E)):B}K=F;for(H=0;H<I;H++){AB=Ax[H];if(d&&AB===o){if(!AA||AC){continue}AC=!0}L>0?D=A.floor(At*(A.abs(AB-o)/L))+1:D=1,AB<o||AB===o&&F===0?(G=K,K+=D):(G=F-D,F-=D),E=this.calcColor(H,AB,Aw),Az&&(E=this.calcHighlightColor(E,Ay)),As.push(Au.drawRect(Av,G,this.barWidth-1,D-1,E,E))}return As.length===1?As[0]:As}}),Ar.fn.sparkline.tristate=Z=Aq(Ar.fn.sparkline._base,Ae,{type:"tristate",init:function(I,H,F,J,D){var E=parseInt(F.get("barWidth"),10),G=parseInt(F.get("barSpacing"),10);Z._super.init.call(this,I,H,F,J,D),this.regionShapes={},this.barWidth=E,this.barSpacing=G,this.totalBarWidth=E+G,this.values=Ar.map(H,Number),this.width=J=H.length*E+(H.length-1)*G,Ar.isArray(F.get("colorMap"))?(this.colorMapByIndex=F.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=F.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===B&&(this.colorMapByValue=new Af(this.colorMapByValue))),this.initTarget()},getRegion:function(F,E,D){return A.floor(E/this.totalBarWidth)},getCurrentRegionFields:function(){var D=this.currentRegion;return{isNull:this.values[D]===B,value:this.values[D],color:this.calcColor(this.values[D],D),offset:D}},calcColor:function(H,F){var G=this.values,K=this.options,D=this.colorMapByIndex,I=this.colorMapByValue,J,E;return I&&(E=I.get(H))?J=E:D&&D.length>F?J=D[F]:G[F]<0?J=K.get("negBarColor"):G[F]>0?J=K.get("posBarColor"):J=K.get("zeroBarColor"),J},renderRegion:function(K,J){var n=this.values,D=this.options,L=this.target,m,G,H,E,F,I;m=L.pixelHeight,H=A.round(m/2),E=K*this.totalBarWidth,n[K]<0?(F=H,G=H-1):n[K]>0?(F=0,G=H-1):(F=H-1,G=2),I=this.calcColor(n[K],K);if(I===null){return}return J&&(I=this.calcHighlightColor(I,D)),L.drawRect(E,F,this.barWidth-1,G-1,I,I)}}),Ar.fn.sparkline.discrete=U=Aq(Ar.fn.sparkline._base,Ae,{type:"discrete",init:function(G,F,H,D,E){U._super.init.call(this,G,F,H,D,E),this.regionShapes={},this.values=F=Ar.map(F,Number),this.min=A.min.apply(A,F),this.max=A.max.apply(A,F),this.range=this.max-this.min,this.width=D=H.get("width")==="auto"?F.length*2:this.width,this.interval=A.floor(D/F.length),this.itemWidth=D/F.length,H.get("chartRangeMin")!==B&&(H.get("chartRangeClip")||H.get("chartRangeMin")<this.min)&&(this.min=H.get("chartRangeMin")),H.get("chartRangeMax")!==B&&(H.get("chartRangeClip")||H.get("chartRangeMax")>this.max)&&(this.max=H.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight=H.get("lineHeight")==="auto"?A.round(this.canvasHeight*0.3):H.get("lineHeight"))},getRegion:function(F,E,D){return A.floor(E/this.itemWidth)},getCurrentRegionFields:function(){var D=this.currentRegion;return{isNull:this.values[D]===B,value:this.values[D],offset:D}},renderRegion:function(u,t){var x=this.values,D=this.options,v=this.min,w=this.max,J=this.range,H=this.interval,I=this.target,i=this.canvasHeight,s=this.lineHeight,K=i-s,L,E,F,G;return E=Ak(x[u],v,w),G=u*H,L=A.round(K-K*((E-v)/J)),F=D.get("thresholdColor")&&E<D.get("thresholdValue")?D.get("thresholdColor"):D.get("lineColor"),t&&(F=this.calcHighlightColor(F,D)),I.drawLine(G,L,G,L+s,F)}}),Ar.fn.sparkline.bullet=S=Aq(Ar.fn.sparkline._base,{type:"bullet",init:function(H,K,D,I,J){var F,G,E;S._super.init.call(this,H,K,D,I,J),this.values=K=An(K),E=K.slice(),E[0]=E[0]===null?E[2]:E[0],E[1]=K[1]===null?E[2]:E[1],F=A.min.apply(A,K),G=A.max.apply(A,K),D.get("base")===B?F=F<0?F:0:F=D.get("base"),this.min=F,this.max=G,this.range=G-F,this.shapes={},this.valueShapes={},this.regiondata={},this.width=I=D.get("width")==="auto"?"4.0em":I,this.target=this.$el.simpledraw(I,J,D.get("composite")),K.length||(this.disabled=!0),this.initTarget()},getRegion:function(G,F,D){var E=this.target.getShapeAt(G,F,D);return E!==B&&this.shapes[E]!==B?this.shapes[E]:B},getCurrentRegionFields:function(){var D=this.currentRegion;return{fieldkey:D.substr(0,1),value:this.values[D.substr(1)],region:D}},changeHighlight:function(G){var E=this.currentRegion,F=this.valueShapes[E],D;delete this.shapes[F];switch(E.substr(0,1)){case"r":D=this.renderRange(E.substr(1),G);break;case"p":D=this.renderPerformance(G);break;case"t":D=this.renderTarget(G)}this.valueShapes[E]=D.id,this.shapes[D.id]=E,this.target.replaceWithShape(F,D)},renderRange:function(G,F){var D=this.values[G],E=A.round(this.canvasWidth*((D-this.min)/this.range)),H=this.options.get("rangeColors")[G-2];return F&&(H=this.calcHighlightColor(H,this.options)),this.target.drawRect(0,0,E-1,this.canvasHeight-1,H,H)},renderPerformance:function(G){var F=this.values[1],D=A.round(this.canvasWidth*((F-this.min)/this.range)),E=this.options.get("performanceColor");return G&&(E=this.calcHighlightColor(E,this.options)),this.target.drawRect(0,A.round(this.canvasHeight*0.3),D-1,A.round(this.canvasHeight*0.4)-1,E,E)},renderTarget:function(H){var G=this.values[0],E=A.round(this.canvasWidth*((G-this.min)/this.range)-this.options.get("targetWidth")/2),F=A.round(this.canvasHeight*0.1),I=this.canvasHeight-F*2,D=this.options.get("targetColor");return H&&(D=this.calcHighlightColor(D,this.options)),this.target.drawRect(E,F,this.options.get("targetWidth")-1,I-1,D,D)},render:function(){var G=this.values.length,E=this.target,F,D;if(!S._super.render.call(this)){return}for(F=2;F<G;F++){D=this.renderRange(F).append(),this.shapes[D.id]="r"+F,this.valueShapes["r"+F]=D.id}this.values[1]!==null&&(D=this.renderPerformance().append(),this.shapes[D.id]="p1",this.valueShapes.p1=D.id),this.values[0]!==null&&(D=this.renderTarget().append(),this.shapes[D.id]="t0",this.valueShapes.t0=D.id),E.render()}}),Ar.fn.sparkline.pie=T=Aq(Ar.fn.sparkline._base,{type:"pie",init:function(I,H,F,J,D){var E=0,G;T._super.init.call(this,I,H,F,J,D),this.shapes={},this.valueShapes={},this.values=H=Ar.map(H,Number),F.get("width")==="auto"&&(this.width=this.height);if(H.length>0){for(G=H.length;G--;){E+=H[G]}}this.total=E,this.initTarget(),this.radius=A.floor(A.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(G,F,D){var E=this.target.getShapeAt(G,F,D);return E!==B&&this.shapes[E]!==B?this.shapes[E]:B},getCurrentRegionFields:function(){var D=this.currentRegion;return{isNull:this.values[D]===B,value:this.values[D],percent:this.values[D]/this.total*100,color:this.options.get("sliceColors")[D%this.options.get("sliceColors").length],offset:D}},changeHighlight:function(G){var E=this.currentRegion,F=this.renderSlice(E,G),D=this.valueShapes[E];delete this.shapes[D],this.target.replaceWithShape(D,F),this.valueShapes[E]=F.id,this.shapes[F.id]=E},renderSlice:function(v,y){var D=this.target,w=this.options,x=this.radius,J=w.get("borderWidth"),K=w.get("offset"),H=2*A.PI,I=this.values,t=this.total,u=K?2*A.PI*(K/360):0,L,s,E,F,G;F=I.length;for(E=0;E<F;E++){L=u,s=u,t>0&&(s=u+H*(I[E]/t));if(v===E){return G=w.get("sliceColors")[E%w.get("sliceColors").length],y&&(G=this.calcHighlightColor(G,w)),D.drawPieSlice(x,x,x-J,L,s,B,G)}u=s}},render:function(){var I=this.target,E=this.values,F=this.options,J=this.radius,D=F.get("borderWidth"),G,H;if(!T._super.render.call(this)){return}D&&I.drawCircle(J,J,A.floor(J-D/2),F.get("borderColor"),B,D).append();for(H=E.length;H--;){E[H]&&(G=this.renderSlice(H).append(),this.valueShapes[H]=G.id,this.shapes[G.id]=H)}I.render()}}),Ar.fn.sparkline.box=X=Aq(Ar.fn.sparkline._base,{type:"box",init:function(G,E,F,D,H){X._super.init.call(this,G,E,F,D,H),this.values=Ar.map(E,Number),this.width=F.get("width")==="auto"?"4.0em":D,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var D=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==B&&D.push({field:"lo",value:this.loutlier}),this.routlier!==B&&D.push({field:"ro",value:this.routlier}),this.lwhisker!==B&&D.push({field:"lw",value:this.lwhisker}),this.rwhisker!==B&&D.push({field:"rw",value:this.rwhisker}),D},render:function(){var Au=this.target,Ax=this.values,Ay=Ax.length,Av=this.options,Aw=this.canvasWidth,j=this.canvasHeight,x=Av.get("chartRangeMin")===B?A.min.apply(A,Ax):Av.get("chartRangeMin"),L=Av.get("chartRangeMax")===B?A.max.apply(A,Ax):Av.get("chartRangeMax"),As=0,At,y,z,F,G,D,E,J,K,H,I;if(!X._super.render.call(this)){return}if(Av.get("raw")){Av.get("showOutliers")&&Ax.length>5?(y=Ax[0],At=Ax[1],F=Ax[2],G=Ax[3],D=Ax[4],E=Ax[5],J=Ax[6]):(At=Ax[0],F=Ax[1],G=Ax[2],D=Ax[3],E=Ax[4])}else{Ax.sort(function(e,d){return e-d}),F=Ah(Ax,1),G=Ah(Ax,2),D=Ah(Ax,3),z=D-F;if(Av.get("showOutliers")){At=E=B;for(K=0;K<Ay;K++){At===B&&Ax[K]>F-z*Av.get("outlierIQR")&&(At=Ax[K]),Ax[K]<D+z*Av.get("outlierIQR")&&(E=Ax[K])}y=Ax[0],J=Ax[Ay-1]}else{At=Ax[0],E=Ax[Ay-1]}}this.quartiles=[F,G,D],this.lwhisker=At,this.rwhisker=E,this.loutlier=y,this.routlier=J,I=Aw/(L-x+1),Av.get("showOutliers")&&(As=A.ceil(Av.get("spotRadius")),Aw-=2*A.ceil(Av.get("spotRadius")),I=Aw/(L-x+1),y<At&&Au.drawCircle((y-x)*I+As,j/2,Av.get("spotRadius"),Av.get("outlierLineColor"),Av.get("outlierFillColor")).append(),J>E&&Au.drawCircle((J-x)*I+As,j/2,Av.get("spotRadius"),Av.get("outlierLineColor"),Av.get("outlierFillColor")).append()),Au.drawRect(A.round((F-x)*I+As),A.round(j*0.1),A.round((D-F)*I),A.round(j*0.8),Av.get("boxLineColor"),Av.get("boxFillColor")).append(),Au.drawLine(A.round((At-x)*I+As),A.round(j/2),A.round((F-x)*I+As),A.round(j/2),Av.get("lineColor")).append(),Au.drawLine(A.round((At-x)*I+As),A.round(j/4),A.round((At-x)*I+As),A.round(j-j/4),Av.get("whiskerColor")).append(),Au.drawLine(A.round((E-x)*I+As),A.round(j/2),A.round((D-x)*I+As),A.round(j/2),Av.get("lineColor")).append(),Au.drawLine(A.round((E-x)*I+As),A.round(j/4),A.round((E-x)*I+As),A.round(j-j/4),Av.get("whiskerColor")).append(),Au.drawLine(A.round((G-x)*I+As),A.round(j*0.1),A.round((G-x)*I+As),A.round(j*0.9),Av.get("medianColor")).append(),Av.get("target")&&(H=A.ceil(Av.get("spotRadius")),Au.drawLine(A.round((Av.get("target")-x)*I+As),A.round(j/2-H),A.round((Av.get("target")-x)*I+As),A.round(j/2+H),Av.get("targetColor")).append(),Au.drawLine(A.round((Av.get("target")-x)*I+As-H),A.round(j/2),A.round((Av.get("target")-x)*I+As+H),A.round(j/2),Av.get("targetColor")).append()),Au.render()}}),W=Aq({init:function(G,E,F,D){this.target=G,this.id=E,this.type=F,this.args=D},append:function(){return this.target.appendShape(this),this}}),P=Aq({_pxregex:/(\d+)(px)?\s*$/i,init:function(F,D,E){if(!F){return}this.width=F,this.height=D,this.target=E,this.lastShapeId=null,E[0]&&(E=E[0]),Ar.data(E,"_jqs_vcanvas",this)},drawLine:function(H,F,G,D,E,I){return this.drawShape([[H,F],[G,D]],E,I)},drawShape:function(G,E,F,D){return this._genShape("Shape",[G,E,F,D])},drawCircle:function(H,F,G,D,E,I){return this._genShape("Circle",[H,F,G,D,E,I])},drawPieSlice:function(I,G,H,E,F,J,D){return this._genShape("PieSlice",[I,G,H,E,F,J,D])},drawRect:function(H,F,G,D,E,I){return this._genShape("Rect",[H,F,G,D,E,I])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(E,D){Ar(D).html(E)},_calculatePixelDims:function(G,E,F){var D;D=this._pxregex.exec(E),D?this.pixelHeight=D[1]:this.pixelHeight=Ar(F).height(),D=this._pxregex.exec(G),D?this.pixelWidth=D[1]:this.pixelWidth=Ar(F).width()},_genShape:function(F,D){var E=R++;return D.unshift(E),new W(this,E,F,D)},appendShape:function(D){alert("appendShape not implemented")},replaceWithShape:function(E,D){alert("replaceWithShape not implemented")},insertAfterShape:function(E,D){alert("insertAfterShape not implemented")},removeShapeId:function(D){alert("removeShapeId not implemented")},getShapeAt:function(F,D,E){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),Q=Aq(P,{init:function(F,E,G,D){Q._super.init.call(this,F,E,G),this.canvas=C.createElement("canvas"),G[0]&&(G=G[0]),Ar.data(G,"_jqs_vcanvas",this),Ar(this.canvas).css({display:"inline-block",width:F,height:E,verticalAlign:"top"}),this._insert(this.canvas,G),this._calculatePixelDims(F,E,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=D,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=B,Ar(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(G,F,D){var E=this.canvas.getContext("2d");return G!==B&&(E.strokeStyle=G),E.lineWidth=D===B?1:D,F!==B&&(E.fillStyle=F),E},reset:function(){var D=this._getContext();D.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=B},_drawShape:function(H,G,K,D,I){var J=this._getContext(K,D,I),E,F;J.beginPath(),J.moveTo(G[0][0]+0.5,G[0][1]+0.5);for(E=1,F=G.length;E<F;E++){J.lineTo(G[E][0]+0.5,G[E][1]+0.5)}K!==B&&J.stroke(),D!==B&&J.fill(),this.targetX!==B&&this.targetY!==B&&J.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=H)},_drawCircle:function(H,K,D,I,J,F,G){var E=this._getContext(J,F,G);E.beginPath(),E.arc(K,D,I,0,2*A.PI,!1),this.targetX!==B&&this.targetY!==B&&E.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=H),J!==B&&E.stroke(),F!==B&&E.fill()},_drawPieSlice:function(I,H,L,D,J,K,F,G){var E=this._getContext(F,G);E.beginPath(),E.moveTo(H,L),E.arc(H,L,D,J,K,!1),E.lineTo(H,L),E.closePath(),F!==B&&E.stroke(),G&&E.fill(),this.targetX!==B&&this.targetY!==B&&E.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=I)},_drawRect:function(I,G,H,E,F,J,D){return this._drawShape(I,[[G,H],[G+E,H],[G+E,H+F],[G,H+F],[G,H]],J,D)},appendShape:function(D){return this.shapes[D.id]=D,this.shapeseq.push(D.id),this.lastShapeId=D.id,D.id},replaceWithShape:function(G,E){var F=this.shapeseq,D;this.shapes[E.id]=E;for(D=F.length;D--;){F[D]==G&&(F[D]=E.id)}delete this.shapes[G]},replaceWithShapes:function(I,G){var H=this.shapeseq,E={},F,J,D;for(J=I.length;J--;){E[I[J]]=!0}for(J=H.length;J--;){F=H[J],E[F]&&(H.splice(J,1),delete this.shapes[F],D=J)}for(J=G.length;J--;){H.splice(D,0,G[J].id),this.shapes[G[J].id]=G[J]}},insertAfterShape:function(G,E){var F=this.shapeseq,D;for(D=F.length;D--;){if(F[D]===G){F.splice(D+1,0,E.id),this.shapes[E.id]=E;return}}},removeShapeId:function(F){var D=this.shapeseq,E;for(E=D.length;E--;){if(D[E]===F){D.splice(E,1);break}}delete this.shapes[F]},getShapeAt:function(F,D,E){return this.targetX=D,this.targetY=E,this.render(),this.currentTargetShapeId},render:function(){var I=this.shapeseq,G=this.shapes,H=I.length,E=this._getContext(),F,J,D;E.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(D=0;D<H;D++){F=I[D],J=G[F],this["_draw"+J.type].apply(this,J.args)}this.interact||(this.shapes={},this.shapeseq=[])}}),N=Aq(P,{init:function(E,F,D){var G;N._super.init.call(this,E,F,D),D[0]&&(D=D[0]),Ar.data(D,"_jqs_vcanvas",this),this.canvas=C.createElement("span"),Ar(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:E,height:F,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,D),this._calculatePixelDims(E,F,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,G='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",G),this.group=Ar(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(o,L,r,D,p){var q=[],G,H,E,F,J,K,I;for(I=0,K=L.length;I<K;I++){q[I]=""+L[I][0]+","+L[I][1]}return G=q.splice(0,1),p=p===B?1:p,H=r===B?' stroked="false" ':' strokeWeight="'+p+'px" strokeColor="'+r+'" ',E=D===B?' filled="false"':' fillColor="'+D+'" filled="true" ',F=q[0]===q[q.length-1]?"x ":"",J='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+o+'" '+H+E+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+G+" l "+q.join(", ")+" "+F+'e"> </v:shape>',J},_drawCircle:function(J,I,l,D,K,L,G){var H,E,F;return I-=D,l-=D,H=K===B?' stroked="false" ':' strokeWeight="'+G+'px" strokeColor="'+K+'" ',E=L===B?' filled="false"':' fillColor="'+L+'" filled="true" ',F='<v:oval  id="jqsshape'+J+'" '+H+E+' style="position:absolute;top:'+l+"px; left:"+I+"px; width:"+D*2+"px; height:"+D*2+'px"></v:oval>',F},_drawPieSlice:function(v,y,D,w,x,J,K,H){var I,t,u,L,s,E,F,G;if(x===J){return""}J-x===2*A.PI&&(x=0,J=2*A.PI),t=y+A.round(A.cos(x)*w),u=D+A.round(A.sin(x)*w),L=y+A.round(A.cos(J)*w),s=D+A.round(A.sin(J)*w);if(t===L&&u===s){if(J-x<A.PI){return""}t=L=y+w,u=s=D}return t===L&&u===s&&J-x<A.PI?"":(I=[y-w,D-w,y+w,D+w,t,u,L,s],E=K===B?' stroked="false" ':' strokeWeight="1px" strokeColor="'+K+'" ',F=H===B?' filled="false"':' fillColor="'+H+'" filled="true" ',G='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+v+'" '+E+F+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+y+","+D+" wa "+I.join(", ")+' x e"> </v:shape>',G)},_drawRect:function(I,G,H,E,F,J,D){return this._drawShape(I,[[G,H],[G,H+F],[G+E,H+F],[G+E,H],[G,H]],J,D)},reset:function(){this.group.innerHTML=""},appendShape:function(E){var D=this["_draw"+E.type].apply(this,E.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",D):this.prerender+=D,this.lastShapeId=E.id,E.id},replaceWithShape:function(G,E){var F=Ar("#jqsshape"+G),D=this["_draw"+E.type].apply(this,E.args);F[0].outerHTML=D},replaceWithShapes:function(H,F){var G=Ar("#jqsshape"+H[0]),E="",I=F.length,D;for(D=0;D<I;D++){E+=this["_draw"+F[D].type].apply(this,F[D].args)}G[0].outerHTML=E;for(D=1;D<H.length;D++){Ar("#jqsshape"+H[D]).remove()}},insertAfterShape:function(G,E){var F=Ar("#jqsshape"+G),D=this["_draw"+E.type].apply(this,E.args);F[0].insertAdjacentHTML("afterEnd",D)},removeShapeId:function(E){var D=Ar("#jqsshape"+E);this.group.removeChild(D[0])},getShapeAt:function(G,E,F){var D=G.id.substr(8);return D},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);