var toMarkdown=function(G){var D=[{patterns:"p",replacement:function(P,O,N){return N?"\n\n"+N+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(R,Q,P,N){var S="";for(var O=0;O<Q;O++){S+="#"}return"\n\n"+S+" "+N+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(Q,P,N){var O=P.match(F("href")),R=P.match(F("title"));return O?"["+N+"]("+O[1]+(R&&R[1]?' "'+R[1]+'"':"")+")":Q}},{patterns:["b","strong"],replacement:function(P,O,N){return N?"**"+N+"**":""}},{patterns:["i","em"],replacement:function(P,O,N){return N?"_"+N+"_":""}},{patterns:"code",replacement:function(P,O,N){return N?"`"+N+"`":""}},{patterns:"img",type:"void",replacement:function(Q,P,N){var R=P.match(F("src")),O=P.match(F("alt")),S=P.match(F("title"));return"!["+(O&&O[1]?O[1]:"")+"]("+R[1]+(S&&S[1]?' "'+S[1]+'"':"")+")"}}];for(var H=0,I=D.length;H<I;H++){if(typeof D[H].patterns==="string"){G=A(G,{tag:D[H].patterns,replacement:D[H].replacement,type:D[H].type})}else{for(var E=0,M=D[H].patterns.length;E<M;E++){G=A(G,{tag:D[H].patterns[E],replacement:D[H].replacement,type:D[H].type})}}}function A(N,R){var Q=R.type==="void"?"<"+R.tag+"\\b([^>]*)\\/?>":"<"+R.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+R.tag+">",O=new RegExp(Q,"gi"),P="";if(typeof R.replacement==="string"){P=N.replace(O,R.replacement)}else{P=N.replace(O,function(T,S,U,V){return R.replacement.call(this,T,S,U,V)})}return P}function F(N){return new RegExp(N+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}G=G.replace(/<pre\b[^>]*>`([\s\S]*)`<\/pre>/gi,function(O,N){N=N.replace(/^\t+/g,"  ");N=N.replace(/\n/g,"\n    ");return"\n\n    "+N+"\n"});G=G.replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");var C=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;while(G.match(C)){G=G.replace(C,function(N){return J(N)})}function J(N){N=N.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(R,S,O){var P=O.split("</li>");P.splice(P.length-1,1);for(H=0,I=P.length;H<I;H++){if(P[H]){var Q=(S==="ol")?(H+1)+".  ":"*   ";P[H]=P[H].replace(/\s*<li[^>]*>([\s\S]*)/i,function(U,T){T=T.replace(/^\s+/,"");T=T.replace(/\n\n/g,"\n\n    ");T=T.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 ");return Q+T})}}return P.join("\n")});return"\n\n"+N.replace(/[ \t]+\n|\s+$/g,"")}var K=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;while(G.match(K)){G=G.replace(K,function(N){return B(N)})}function B(N){N=N.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(O,P){P=P.replace(/^\s+|\s+$/g,"");P=L(P);P=P.replace(/^/gm,"> ");P=P.replace(/^(>([ \t]{2,}>)+)/gm,"> >");return P});return N}function L(N){N=N.replace(/^[\t\r\n]+|[\t\r\n]+$/g,"");N=N.replace(/\n\s+\n/g,"\n\n");N=N.replace(/\n{3,}/g,"\n\n");return N}return L(G)};if(typeof exports==="object"){exports.toMarkdown=toMarkdown};